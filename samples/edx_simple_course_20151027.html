<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>OCV</title>
    <meta name="description" content="Online Course Visualizer">

    <style>
        html {
            display: table;
            margin: auto;
        }

        body {
            display: table-cell;
            font-family: 'Cantarell';
            font-size: 100%;
            vertical-align: middle;
        }

        .link {
            fill: none;
            stroke: #ccc;
            stroke-width: 2px;
        }
    </style>

    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.6/d3.min.js">
    </script>
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Cantarell" />
</head>

<body>
<h1>Online Course Visualizations</h1>
<p>Below are visualizations from the edX demo course. This course was picked due to the size, scope,
and variety of components it offers.</p>

<h3>Section 1</h3>
<div id="section1"></div>

<script type="text/javascript">
var data = [
	{ "name": "Section 1", "parent": "null", "type": "chapter", "icon": "\uf19c"},
	{ "name": "Subsection 1.1", "parent": "Section 1", "type": "sequential", "icon": "\uf02d"},
	{ "name": "Unit 1.1.1", "parent": "Subsection 1.1", "type": "vertical", "icon": "\uf0c9"},
	{ "name": "Checkboxes", "parent": "Unit 1.1.1", "type": "problem", "icon": "\uf0ae"},
	{ "name": "Subsection 1.2", "parent": "Section 1", "type": "sequential", "icon": "\uf02d"},
	{ "name": "Unit 1.2.1", "parent": "Subsection 1.2", "type": "vertical", "icon": "\uf0c9"},
	{ "name": "Dropdown", "parent": "Unit 1.2.1", "type": "problem", "icon": "\uf0ae"},
	{ "name": "Unit 1.2.2", "parent": "Subsection 1.2", "type": "vertical", "icon": "\uf0c9"},
	{ "name": "Dropdown", "parent": "Unit 1.2.2", "type": "problem", "icon": "\uf0ae"},
	];
var dataMap = data.reduce(function(map, node) {
            map[node.name] = node;
            return map;
        }, {});

        var treeData = [];
        data.forEach(function(node) {
            // add to parent
            var parent = dataMap[node.parent];
            if (parent) {
                // create child array if it doesn't exist
                (parent.children || (parent.children = []))
                // add node to child array
                .push(node);
            } else {
                // parent is null or missing
                treeData.push(node);
            }
        });
        // ************** Generate the tree diagram	 *****************
        var margin = {
                top: 20,
                right: 120,
                bottom: 20,
                left: 120
            },
            width = 960 - margin.right - margin.left,
            height = 500 - margin.top - margin.bottom;

        var i = 0;

        var tree = d3.layout.tree()
            .size([height, width]);

        var diagonal = d3.svg.diagonal()
            .projection(function(d) {
                return [d.y, d.x];
            });

        var svg = d3.select("#section1").append("svg")
.attr("width", width + margin.right + margin.left)
                .attr("height", height + margin.top + margin.bottom)
                .append("g")
                .attr("transform", "translate(" + margin.left + "," + margin.top + ")");

            root = treeData[0];

            update(root);

            function update(source) {

                // Compute the new tree layout.
                var nodes = tree.nodes(root).reverse(),
                    links = tree.links(nodes);

                // Normalize for fixed-depth.
                nodes.forEach(function(d) {
                    d.y = d.depth * 180;
                });

                // Declare the nodes!
                var node = svg.selectAll("g.node")
                    .data(nodes, function(d) {
                        return d.id || (d.id = ++i);
                    });

                // Enter the nodes.
                var nodeEnter = node.enter().append("g")
                    .attr("class", "node")
                    .attr("transform", function(d) {
                        return "translate(" + d.y + "," + d.x + ")";
                    });

                nodeEnter.append('text')
                        .attr('text-anchor', 'middle')
                        .attr('dominant-baseline', 'central')
                        .attr('font-family', 'FontAwesome')
                        .text(function(d) { return d.icon; });

                nodeEnter.append("text")
                    .attr("x", function(d) {
                        return d.children || d._children ? -13 : 13;
                    })
                    .attr("dy", ".35em")
                    .attr("text-anchor", function(d) {
                        return d.children || d._children ? "end" : "start";
                    })
                    .text(function(d) {
                        return d.name;
                    })
                    .style("fill-opacity", 1);

                // Declare the links!
                var link = svg.selectAll("path.link")
                    .data(links, function(d) {
                        return d.target.id;
                    });

                // Enter the links.
                link.enter().insert("path", "g")
                    .attr("class", "link")
                    .attr("d", diagonal);

            }

</script>

</body>
</html>
